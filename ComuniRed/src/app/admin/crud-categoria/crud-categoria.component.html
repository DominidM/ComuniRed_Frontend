<div class="crud-rol-root">
  <div class="crud-rol-card">
    <div class="crud-rol-header">
      <h2>Gesti칩n de Categor칤as</h2>
      <button class="btn-primary" (click)="openAddModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Nueva Categor칤a
      </button>
    </div>

    <div class="crud-rol-controls-row">
      <!-- Si vas a implementar b칰squeda paginada, aqu칤 puedes agregar el filtro por nombre -->
      <!-- Por ahora, solo frontend paginaci칩n 游땎 -->
      <div class="crud-rol-show-select">
        <label for="pageSize">por p치gina</label>
        <select id="pageSize" (change)="onPageSizeChange($event)" [value]="pageSize">
          <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
        </select>
        <span>Total: {{ totalCategorias }}</span>
      </div>
    </div>

    <div *ngIf="categorias && categorias.length > 0; else noCategorias">
      <table class="crud-rol-table">
        <thead>
          <tr>
            <th style="display: none;">ID</th>
            <th>Nombre</th>
            <th>Descripci칩n</th>
            <th>Activo</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cat of categorias; trackBy: trackByCategoriaId">
            <td style="display: none;">{{ cat.id }}</td>
            <td>
              <div class="role-name">{{ cat.nombre }}</div>
            </td>
            <td>
              <div class="role-description">{{ cat.descripcion }}</div>
            </td>
            <td>
              <span class="status-badge" [class.status-active]="cat.activo" [class.status-inactive]="!cat.activo">
                {{ cat.activo ? 'S칤' : 'No' }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-edit" (click)="editarCategoria(cat)" title="Editar categor칤a">Editar</button>
                <button class="btn-delete" (click)="eliminarCategoria(cat.id)" title="Eliminar categor칤a">Eliminar</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noCategorias>
      <div class="crud-rol-empty">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 1rem; color: #000000;">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        <p>No hay categor칤as registradas</p>
        <button class="btn-primary" (click)="openAddModal()" style="margin-top: 1rem;">
          Crear primera categor칤a
        </button>
      </div>
    </ng-template>

    <div class="crud-rol-pagination-row" *ngIf="categorias.length > 0">
      <div class="crud-rol-pagination">
        <button class="crud-rol-pagination-btn" (click)="cambiarPagina(currentPage - 1)" [disabled]="currentPage === 1">
          &lt; Anterior
        </button>
        <span class="crud-rol-pagination-info">
          P치gina {{ currentPage }} de {{ totalPages }}
        </span>
        <button class="crud-rol-pagination-btn" (click)="cambiarPagina(currentPage + 1)" [disabled]="currentPage === totalPages">
          Siguiente &gt;
        </button>
      </div>
      <div class="crud-rol-pagination-count">
        <span>Mostrando {{ categorias.length }} de {{ totalCategorias }} datos.</span>
      </div>
    </div>

    <div class="crud-rol-modal" *ngIf="showModal" (click)="closeModal()">
      <div class="crud-rol-modal-content" (click)="$event.stopPropagation()">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          {{ editingCategoria ? 'Editar Categor칤a' : 'Nueva Categor칤a' }}
        </h3>
        <form (ngSubmit)="guardarCategoria()" #categoriaForm="ngForm">
          <div class="form-group">
            <label for="nombre">Nombre de la Categor칤a</label>
            <input 
              id="nombre" 
              name="nombre" 
              type="text"
              [(ngModel)]="nombre" 
              required 
              placeholder="Ej: Electr칩nica, Ropa, Alimentos..."
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="descripcion">Descripci칩n</label>
            <input 
              id="descripcion" 
              name="descripcion" 
              type="text"
              [(ngModel)]="descripcion" 
              placeholder="Describe las caracter칤sticas de esta categor칤a..."
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                name="activo" 
                [(ngModel)]="activo"
                class="checkbox-input"
              />
              <span class="checkbox-text">Categor칤a activa</span>
            </label>
          </div>
          <div class="crud-rol-modal-actions">
            <button type="button" class="btn-cancel" (click)="closeModal()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
              Cancelar
            </button>
            <button type="submit" class="btn-primary" [disabled]="!categoriaForm.valid">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20,6 9,17 4,12"></polyline>
              </svg>
              {{ editingCategoria ? 'Actualizar' : 'Guardar' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
