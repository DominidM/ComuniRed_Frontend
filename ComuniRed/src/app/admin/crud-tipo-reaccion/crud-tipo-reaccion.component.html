<div class="crud-tipo-reaccion-root">
  <div class="crud-tipo-reaccion-card">

    <div class="crud-tipo-reaccion-header">
      <h2>Gestión de Tipos de Reacción</h2>
      <button class="btn-primary" (click)="openAddModal()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Nuevo Tipo
      </button>
    </div>

    <div class="crud-tipo-reaccion-controls-row">
      <div class="crud-tipo-reaccion-show-select">
        <label for="pageSize">por página</label>
        <select id="pageSize" (change)="onPageSizeChange($event)" [value]="pageSize">
          <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
        </select>
        <span>Total: {{ totalTipos }}</span>
      </div>
    </div>

    <div *ngIf="tipos.length > 0; else noTipos">
      <table class="crud-tipo-reaccion-table">
        <thead>
          <tr>
            <th style="display: none;">ID</th>
            <th>Clave (Key)</th>
            <th>Nombre (Label)</th>
            <th>Estado</th>
            <th>Orden</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let tipo of tipos; trackBy: trackByTipoId">
            <td style="display: none;">{{ tipo.id }}</td>
            <td><div class="tipo-key"><span class="badge-key">{{ tipo.key }}</span></div></td>
            <td><div class="tipo-nombre">{{ tipo.label }}</div></td>
            <td>
              <span class="status-badge" [class.status-active]="tipo.activo" [class.status-inactive]="!tipo.activo">
                {{ tipo.activo ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
            <td><span class="orden-badge">{{ tipo.orden }}</span></td>
            <td>
              <div class="action-buttons">
                <button class="btn-edit" (click)="openEditModal(tipo)" title="Editar tipo">Editar</button>
                <button class="btn-delete" (click)="deleteTipo(tipo)" title="Eliminar tipo">Eliminar</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noTipos>
      <div class="crud-tipo-reaccion-empty">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <circle cx="12" cy="12" r="10"></circle>
          <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
          <line x1="9" y1="9" x2="9.01" y2="9"></line>
          <line x1="15" y1="9" x2="15.01" y2="9"></line>
        </svg>
        <p>No hay tipos de reacción registrados</p>
        <button class="btn-primary" (click)="openAddModal()" style="margin-top: 1rem;">
          Crear primer tipo
        </button>
      </div>
    </ng-template>

    <div class="crud-tipo-reaccion-pagination-row" *ngIf="totalTipos > 0">
      <div class="crud-tipo-reaccion-pagination">
        <button class="crud-tipo-reaccion-pagination-btn" (click)="cambiarPagina(currentPage - 1)" [disabled]="currentPage === 1">
          &lt; Anterior
        </button>
        <span class="crud-tipo-reaccion-pagination-info">
          Página {{ currentPage }} de {{ totalPages }}
        </span>
        <button class="crud-tipo-reaccion-pagination-btn" (click)="cambiarPagina(currentPage + 1)" [disabled]="currentPage === totalPages">
          Siguiente &gt;
        </button>
      </div>
      <div class="crud-tipo-reaccion-pagination-count">
        <span>Mostrando {{ tipos.length }} de {{ totalTipos }} datos.</span>
      </div>
    </div>

    <div class="crud-tipo-reaccion-modal" *ngIf="showModal" (click)="closeModal()">
      <div class="crud-tipo-reaccion-modal-content" (click)="$event.stopPropagation()">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
            <line x1="9" y1="9" x2="9.01" y2="9"></line>
            <line x1="15" y1="9" x2="15.01" y2="9"></line>
          </svg>
          {{ editingTipo ? 'Editar Tipo de Reacción' : 'Nuevo Tipo de Reacción' }}
        </h3>
        <form (ngSubmit)="saveTipo()" #tipoForm="ngForm">
          <div class="form-group">
            <label for="key">Clave (Key)</label>
            <input 
              id="key" 
              name="key" 
              type="text"
              [(ngModel)]="tipoData.key" 
              required 
              maxlength="50"
              autocomplete="off"
            />
            <small class="form-help">Identificador único del tipo de reacción</small>
          </div>
          <div class="form-group">
            <label for="label">Nombre (Label)</label>
            <input 
              id="label" 
              name="label" 
              type="text"
              [(ngModel)]="tipoData.label" 
              required 
              maxlength="100"
              autocomplete="off"
            />
            <small class="form-help">Nombre visible del tipo de reacción</small>
          </div>
          <div class="form-group">
            <label for="orden">Orden</label>
            <input 
              id="orden" 
              name="orden" 
              type="number"
              [(ngModel)]="tipoData.orden" 
              required 
              min="1"
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label class="checkbox-label">
              <input 
                type="checkbox" 
                name="activo" 
                [(ngModel)]="tipoData.activo"
                class="checkbox-input"
              />
              <span class="checkbox-text">Tipo de reacción activo</span>
            </label>
          </div>
          <div class="crud-tipo-reaccion-modal-actions">
            <button type="button" class="btn-cancel" (click)="closeModal()">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
              Cancelar
            </button>
            <button type="submit" class="btn-primary" [disabled]="!tipoForm.valid">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20,6 9,17 4,12"></polyline>
              </svg>
              {{ editingTipo ? 'Actualizar' : 'Guardar' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
