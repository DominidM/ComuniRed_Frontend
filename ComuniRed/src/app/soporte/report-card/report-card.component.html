<div class="reporte-card" [ngClass]="getEstadoClase()" [class.expanded]="mostrarDetalles">
  <!-- Header -->
  <div class="reporte-header">
    <img [src]="reporte.usuarioAvatar" alt="avatar" class="avatar">
    <div class="usuario-info">
      <h4>{{ reporte.titulo }}</h4>
      <small>👤 {{ reporte.usuario }}</small>
    </div>
  </div>

  <!-- Imagen principal -->
  <img *ngIf="reporte.imagenPrincipal"
       [src]="reporte.imagenPrincipal"
       alt="imagen principal"
       class="imagen-principal"
       (click)="abrirImagenCompleta(reporte.imagenPrincipal)">

  <!-- Miniaturas -->
  <div class="imagenes" *ngIf="reporte.imagenes?.length">
    <img *ngFor="let img of reporte.imagenes"
         [src]="img"
         alt="imagen mini"
         class="imagen-mini"
         (click)="abrirImagenCompleta(img)">
  </div>

  <!-- Cuerpo -->
  <div class="reporte-body">
    <p><strong>Ubicación:</strong> {{ reporte.ubicacion }}</p>
    <p *ngIf="reporte.telefono"><strong>Teléfono:</strong> {{ reporte.telefono }}</p>
    <p><strong>Descripción:</strong> {{ reporte.descripcion }}</p>
    <p><strong>Fecha:</strong> {{ reporte.fecha | date:'mediumDate' }}</p>
  </div>

  <!-- Footer -->
  <div class="reporte-footer">
    <div class="reacciones">
      👍 {{ reporte.reacciones.likes }}
      👎 {{ reporte.reacciones.dislikes }}
      ⚠️ {{ reporte.reacciones.reportes }}
      ❤️ {{ reporte.reacciones.love }}
      😮 {{ reporte.reacciones.wow }}
      😔 {{ reporte.reacciones.sad }}
      ☑️ {{ reporte.reacciones.helpful }}
    </div>

    <div class="botones">
      <button class="btn btn-detalles" (click)="abrirDetalles($event)">👁 Ver Detalles</button>
      <button class="btn btn-ubicacion" (click)="abrirUbicacion($event)">📍 Ver Ubicación</button>
    </div>
  </div>
</div>

<!-- Modal Imagen GLOBAL -->
<div class="modal-imagen" *ngIf="imagenSeleccionada" (click)="cerrarImagenCompleta()">
  <div class="modal-contenido-imagen" (click)="$event.stopPropagation()">
    <img [src]="imagenSeleccionada" alt="Imagen completa">
    <button class="btn-cerrar" (click)="cerrarImagenCompleta()">✖</button>
  </div>
</div>

<app-modal-detalles 
  *ngIf="mostrarDetalles"
  [reporte]="reporte"
  (cerrar)="cerrarDetalles()">
</app-modal-detalles>

<app-modal-ubicacion
  *ngIf="mostrarUbicacion"
  [ubicacion]="reporte.ubicacion"
  (cerrar)="cerrarUbicacion()">
</app-modal-ubicacion>
